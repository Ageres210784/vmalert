---
vmalert_docker_network_name: prom_network
vmalert_container_name: vmalert
vmalert_docker_image: "victoriametrics/vmalert:v1.63.0"
vmalert_docker_labels:
  - vmalert
vmalert_config_dir: /var/lib/vmalert

vmalert_command:
  # vmselect or balancer
  - '--datasource.url=http://{{ ansible_host }}:8481/select/0/prometheus'
  - '--remoteRead.url=http://{{ ansible_host }}:8481/select/0/prometheus'
  # vminsert or balancer
  - '--remoteWrite.url=http://{{ ansible_host }}:8480/insert/0/prometheus'
  # alertmanager
  - '--notifier.url=http://{{ ansible_host }}:9093/'
  - '--rule=/etc/alerts/*.yml'
  # display source of alerts in grafana
  - '-external.url=http://{{ ansible_host }}:3000' #grafana outside container
  # when copypaste the line below be aware of '$$' for escaping in '$expr'
  - !unsafe '--external.alert.source=explore?orgId=1&left=["now-1h","now","VictoriaMetrics",{"expr":"{{$$expr|quotesEscape|crlfEscape|queryEscape}}"},{"mode":"Metrics"},{"ui":[true,true,true,"none"]}]'

vmalert_reload_url: 'http://127.0.0.1:8880/-/reload'
